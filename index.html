<!DOCTYPE html>
<html>
<head>
  <title>Arbitrage Betting Calculator</title>
  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>
</head>
<body>

  <h1>Arbitrage Betting Calculator</h1>

  <label>First Odds (example: (-450,+350)):</label><br>
  <input type="text" id="odd1"><br><br>

  <label>Second Odds (example: (-520,+400)):</label><br>
  <input type="text" id="odd2"><br><br>

  <label>Stake or Profit? (S or P):</label><br>
  <input type="text" id="mode"><br><br>

  <label>Amount (Stake or Profit Goal):</label><br>
  <input type="number" id="amount"><br><br>

  <button py-click="calculate()">Calculate</button>

  <div id="output"></div>

  <py-script>
import random

def calculate():
    output = Element("output")
    output.element.innerText = ""

    odd_set1 = Element("odd1").element.value
    odd_set2 = Element("odd2").element.value
    path = Element("mode").element.value.strip().lower()
    amount = float(Element("amount").element.value)

    try:
        # Parse odds
        site1_neg = int(odd_set1[odd_set1.find('-')+1 : odd_set1.find(',')])
        site1_pos = int(odd_set1[odd_set1.find('+')+1 : len(odd_set1)-1])
        site2_neg = int(odd_set2[odd_set2.find('-')+1 : odd_set2.find(',')])
        site2_pos = int(odd_set2[odd_set2.find('+')+1 : len(odd_set2)-1])

        # Convert to decimal odds
        site1_negdec = (100/site1_neg)+1
        site1_posdec = (site1_pos/100)+1
        site2_negdec = (100/site2_neg)+1
        site2_posdec = (site2_pos/100)+1

        # Best values
        best_neg = max(site1_negdec, site2_negdec)
        best_pos = max(site1_posdec, site2_posdec)

        prob_neg = 1 / best_neg
        prob_pos = 1 / best_pos
        combined_prob = (prob_neg + prob_pos) * 100

        if combined_prob >= 100:
            insult = random.choice(['Get a job buddy', 'You thought idiot', "You're a bum"])
            output.element.innerText = f'Odds cannot be used for arbitrage.\n{insult}'
            return
        else:
            output.element.innerText += "Odds can be used for arbitrage.\n"

        profit_percent = abs(((1 / best_neg) + (1 / best_pos)) - 1) * 100

        if path == 's':
            ab = amount
            a = ab / (1 + (best_neg / best_pos))
            b = ab - a
            profit = (ab * (profit_percent/100)) + ab
            output.element.innerText += f'With a total stake of ${ab:.2f}:\nBet ${a:.2f} on the + odds\nBet ${b:.2f} on the - odds\n{profit_percent:.2f}% ROI\nExpected return: ${profit:.2f}'
        elif path == 'p':
            goal_profit = amount
            total_stake = goal_profit / (profit_percent/100)
            a = total_stake / (1 + (best_neg / best_pos))
            b = total_stake - a
            output.element.innerText += f'To make ${goal_profit:.2f} profit:\nStake ${total_stake:.2f} total\nBet ${a:.2f} on the + odds\nBet ${b:.2f} on the - odds'
        else:
            output.element.innerText = 'Input Error: Enter "S" or "P"'
    except Exception as e:
        output.element.innerText = f"Error: {str(e)}"
  </py-script>

</body>
</html>
